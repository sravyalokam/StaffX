<div class="flex items-center justify-between mx-5 my-5">
  <p class="text-xl font-bold">Role Assignment</p>
  <button type="button" class="text-white bg-blue-700 hover:bg-blue-800 rounded-md px-4 py-2 transition-colors"
    (click)="openModel()">
    Assign Role
  </button>
</div>

<div *ngIf="isOpenModel" class="fixed inset-0 bg-opacity-50 z-40"></div>

<div *ngIf="isOpenModel"
  class="fixed right-0 top-0 h-full w-full max-w-md bg-white z-50 shadow-lg overflow-y-auto transition-transform duration-300">
  <div class="flex items-center justify-between p-4 border-b">
    <p class="text-xl font-semibold">Assign Role</p>
    <button (click)="closeModel()" class="text-2xl font-bold text-gray-600 hover:text-black">&times;</button>
  </div>

  <form [formGroup]="assignRoleForm" (ngSubmit)="onSubmit()" class="p-4 space-y-6">
    <!-- <div>
      <label for="employee" class="block mb-1 font-medium">
        Search Employees <span class="text-red-700">*</span>
      </label>
      <select id="employee" formControlName="selectedEmployee" class="w-full border px-3 py-2 rounded">
        <option value="">Select Employee</option>
        <option *ngFor="let e of emp" [value]="e.employee_id">{{ e.name }}</option>
      </select>
      <div *ngIf="isSubmitted && assignRoleForm.get('selectedEmployee')?.invalid" class="text-red-600 text-sm mt-1">
        Please select the Employee
      </div>
    </div> -->


    <mat-form-field appearance="fill" class="w-full">
    <mat-label>Select Employees </mat-label>
    <mat-select formControlName="selectedEmployee">
      <mat-option value="">Select Employee</mat-option>
      <mat-option *ngFor="let e of emp" [value]="e.employee_id">
        {{ e.name }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="isSubmitted && assignRoleForm.get('selectedEmployee')?.invalid">
      Please select the Employee
    </mat-error>
  </mat-form-field>


  <mat-form-field appearance="fill" class="w-full">
    <mat-label>Select Roles </mat-label>
    <mat-select formControlName="selectedRole">
      <mat-option value="">Select Role</mat-option>
      <mat-option *ngFor="let r of roles" [value]="r.id">
        {{ r.display_name }}
      </mat-option>
    </mat-select>
    <mat-error *ngIf="isSubmitted && assignRoleForm.get('selectedRole')?.invalid">
      Please select the Role
    </mat-error>
  </mat-form-field>

    <!-- <div>
      <label for="role" class="block mb-1 font-medium">
        Search Roles <span class="text-red-700">*</span>
      </label>
      <select id="role" formControlName="selectedRole" class="w-full border px-3 py-2 rounded">
        <option value="">Select Role</option>
        <option *ngFor="let r of roles" [value]="r.id">{{ r.display_name }}</option>
      </select>
      <div *ngIf="isSubmitted && assignRoleForm.get('selectedRole')?.invalid" class="text-red-600 text-sm mt-1">
        Please select the Role
      </div>
    </div> -->

    <div class="text-right">
      <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">
        Assign Role
      </button>
    </div>
  </form>
</div>

<div class="m-5 border shadow-xl rounded-md overflow-auto max-h-[500px]">
  <table class="table-auto md:table-fixed border-collapse border border-gray-400 w-full">
    <thead class="sticky top-0 z-10 bg-gray-100 border-gray-300">
      <tr class="border border-gray-300 text-left">
        <th class="border border-gray-300 px-4 py-2 text-gray-500 text-[12px] font-medium">{{ 'Name' | uppercase }}</th>
        <th class="border border-gray-300 px-4 py-2 text-gray-500 text-[12px] font-medium"> {{ 'Email' | uppercase }}
        </th>
        <th class="border border-gray-300 px-4 py-2 text-gray-500 text-[12px] font-medium"> {{ 'Role' | uppercase }}
        </th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let e of empRoles" class="border border-gray-300 text-left">
        <td class="border border-gray-300 px-4 py-2">{{ e.name }}</td>
        <td class="border border-gray-300 px-4 py-2">{{ e.email }}</td>
        <td class="border border-gray-300 px-4 py-2">
          <div *ngIf="e.roles?.length">
            <span *ngFor="let r of e.roles; let last = last">
              {{ r.role }}<span *ngIf="!last">, </span>
            </span>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>